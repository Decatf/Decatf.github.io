<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
	<link rel="stylesheet" type="text/css" href="css/StyleSheet.css"/>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="js/finance.js"></script>
    <script src="js/PatternAnnotation.js"></script>
    <script src="js/Chart.js"></script>
    <script src="js/DataService.js"></script>
    
    
    <script  type="text/javascript">
        var symbol = null;
        //var wcf_error = false;

        function symbolButton() {
            new_symbol = document.getElementById("symbol_textbox").value;
            var new_symbol = new_symbol.toUpperCase();

            if (symbol == null || symbol != new_symbol) {
                symbol = new_symbol;
                CallService(symbol);
            }
            //if (wcf_error == true) {
            //    GetYahooData(symbol);
            //}
        }

        function handleFileSelect(evt) {
            var files = evt.target.files; // FileList object

            // files is a FileList of File objects. 
            for (var i = 0, f; f = files[i]; i++) {
                var reader = new FileReader();

                // Closure to capture the file information.
                reader.onload = (function (theFile) {
                    return function (e) {
                        updateAnnotationLists(reader);
                    };
                })(f);

                // Read in the txt file
                reader.readAsText(f);
            }
        }

        var buffer = []
        function onKeyPress() {
            var x;
            if (window.event) // IE8 and earlier
            {
                x = event.keyCode;
            }
            else if (event.which) // IE9/Firefox/Chrome/Opera/Safari
            {
                x = event.which;
            }
            keychar = String.fromCharCode(x);
            buffer.push(keychar);
            if (buffer.length > 4) {
                buffer.splice(0, buffer.length - 4);
            }

            var str = buffer.join().replace(new RegExp(",", 'g'), "");
            if (str == "poiu") {
                document.getElementById('files').click();
            }
        }

    </script>
</head>
<body onkeypress="onKeyPress()">
    Symbol: <input id="symbol_textbox" type="text" name="symbol"/>
    <input type="submit" value="Submit" onclick="symbolButton()"/>
    <input type="file" id="files" name="files[]" />
    <script>
        document.getElementById('files')
            .addEventListener('change', handleFileSelect, false);
    </script>

    <p id="resultText"></p>
    
    <div id="symbols">
        <table id="symbol_table">
            <tr>
                <td>
                    <div id="chart"></div>
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
